<meta charset="UTF-8">
<html>

<head>
	<title>oxDNA three.js viewer</title>

	<!--Nice icons: http://google.github.io/material-design-icons/-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	  rel="stylesheet">

	<!--Link external stylesheet file-->
	<link rel="stylesheet" href="style.css">

</head>

<body>
	<div id="dragInstruction">Drag and drop oxDNA .conf and .top files below</div>
	<div class="sidenav">
		<!--sidebar-->
		<div class="tab">
			<!--2 tabs: Nucleotides. Strands(not used)-->
			<button class="tablinks active" onclick="openTab(event, 'Nucleotides')">Bases</button>
			<button class="tablinks" onclick="openTab(event, 'Strands')">Strands</button>
		</div>
		<div id="Nucleotides" class="tabcontent">
			<textarea id="BaseList" cols="25" rows="3" name="textarea" readonly> Selected Bases List </textarea>
			<button onclick="makeSelectedBasesFile()" type="button" title="Download plain-text file of selected bases">Download Selected Base List</button>
			<button onclick="makeMutualTrapFile()" type="button" title="Create mutual trap file pairing every two bases in the selected base list">Make Mutual Trap File</button>
			<button onclick="makeOutputFiles()" type="button" title="Download the current scene in oxDNA format">Download Output Files<br>(.dat and .top)</button>
			<button onclick="toggleVideoOptions()" type="button" title="Create a video of the trajectory starting with the current frame">Create Video</button>
			<fieldset>
				<legend>PBC / Centering</legend>
				<caption> PBC: </caption>
				<select id="inboxing" title="At what scale to apply periodic boundary conditions">
					<option>Monomer</option>
					<option>Strand</option>
					<option>None</option>
				</select>
				<br>
				<caption>Centering:</caption>
				<select id="centering" title="Where to center the structure relative to the simulation box">
					<option>Origin</option>
					<option>Box Center</option>
					<option>None</option>
				</select>
				<br>
				<button onclick="systems.forEach( (s) => { PBC_switchbox(s)}); render()" type="button" title="note this only works if you're going from none to something else or if you want to re-center after moving">Apply</button>
			</fieldset>
			<!--<input type="checkbox" id="centering" onchange="centerSystems()" checked>Center Systems-->
			<fieldset>
				<legend>View</legend>
				<input type="checkbox" id="arrowToggle" onchange="toggleArrows(this)" title="Show/hide the coordinate axes" checked>Display Arrows<br>
				<fieldset>
					<legend>Color by:</legend>
					<input type="radio" name="coloring" value="Strand" onchange="coloringChanged()" checked>Strand
					<input type="radio" name="coloring" value="Cluster" onchange="coloringChanged()">Cluster
					<input type="radio" name="coloring" value="System" onchange="coloringChanged()">System
					<input type="radio" name="coloring" value="Overlay" onchange="coloringChanged()">Overlay
				</fieldset>
				<input type="checkbox" id="backgroundToggle" onchange="toggleBackground()" title="White or black background?">Toggle Background Color<br>
				<button onclick="toggleColorOptions()" type="button" title="modify the default strand colors">Edit Colors</button>
				<button onclick="controls.reset()" type="button" title="moves camera to default position (100,0,0)">Reset Camera</button>
				<button onclick="toggleFogOptions()" type="button" title="View fog options">Fog</button>
			</fieldset>
			<fieldset>
				<legend>Edit</legend>
				<div style="text-align: center;">
					<i class="material-icons" onclick="editHistory.undo()" title="Undo edit (ctrl-z)">undo</i>
					<i class="material-icons" onclick="editHistory.redo()" title="Redo edit (ctrl-shift-z)">redo</i>
				</div>
				<input type="checkbox" name="action" id="selectToggle" value="Select" checked title="Hold down ctrl for multiple selection"> Select
				<input type="checkbox" name="action" id="dragToggle"value="Drag"> Drag<br>
				<fieldset>
					<legend>Selection mode:</legend>
					<input type="radio" name="scope" value="Monomer"  checked>Monomer<br> <!--default mode is Nucleotide-->
					<input type="radio" name="scope" value="Strand">Strand<br>
					<input type="radio" name="scope" value="System">System<br>
					<input type="radio" name="scope" value="Cluster" title="Select by clusters calculated by DBSCAN"
						onchange="if (typeof elements[0].cluster_id == 'undefined') {toggleClusterOptions();}">
						Cluster <i class="material-icons" onclick="toggleClusterOptions()" title="Clustering options" style="font-size: 1.5em; vertical-align: middle">tune</i><br>
					<input type="radio" name="scope" value="Box" title="Draw a rectangle and select everything within it">Box<br>
				</fieldset>
				<fieldset>
					<legend>Rotate:</legend>
					Axis:
					<input type="radio" name="rotate" value="X" checked>X <!--default checked is x-axis-->
					<input type="radio" name="rotate" value="Y">Y
					<input type="radio" name="rotate" value="Z">Z<br>
					Rotation angle:
					<input type="number" value="-90" id="rotAngle" width="20">
					<button onclick="rotateByInput()" title="rotate selected objects around center of mass specified by the selection mode by the rotation angle">Rotate</button>
				</fieldset>
				<input type="checkbox" id="clusterSim" onchange="toggleClusterSim()">Rigid cluster dynamics<br>
			</fieldset>
			<textarea id="BaseInfo" cols="25" rows="10" name="textarea" readonly> Selected Base Information </textarea>
			<div style="text-align: center;">
				<i class="material-icons" onclick="previousConfig()" style="font-size: 48px;" title="Previous config (left keyboard arrow)">keyboard_arrow_left</i>
				<i class="material-icons" onclick="nextConfig()" style="font-size: 48px;" title="Next config (right keyboard arrow)">keyboard_arrow_right</i>
			</div>
			</div>
			<div id="Strands" class="tabcontent" style="display: none">
				<button>TEST</button>
			</div>
			<button onclick="toggleSideNav(this)"type="button" style="background-color: #acc; border: 0px; height: 20px; padding: 0px;">hide</button>
		</div>
		<div style="position: absolute; bottom: 0px; overflow-y: scroll; max-height: 100%;">
			<div class="opts" id="videoOptions" hidden="true">
				<div style="text-align: right; background-color: #acc">
					<i class="material-icons" onclick="toggleVideoOptions()">close</i>
				</div>
				<label for="videoType">Video type:</label>
				<select id="videoType">
					<option value="trajectory">Trajectory</option>
					<option value="lemniscate">XY leminiscate</option>
				</select>
				<fieldset>
					<legend>File format:</legend>
					<input type="radio" name="videoFormat" value="webm" checked>webm<br>
					<input type="radio" name="videoFormat" value="gif" >gif<br>
					<input type="radio" name="videoFormat" value="png" >png<br>
					<input type="radio" name="videoFormat" value="jpg" >jpg<br>
				</fieldset>
				<label for="videoFramerate">Framerate:</label>
				<input type="number" value="24" id="videoFramerate" width="20">
				<button id="videoStartStop" onclick="createVideo()">Start</button>
			</div>
			<div class="opts" id="colorOptions" hidden="true">
				<div style="text-align: right; background-color: #acc">
						<i class="material-icons" onclick="toggleColorOptions()">close</i>
				</div>
				Click a color to edit, right click to remove:
				<div id="colorOptionContent" style="background-color: inherit"></div>
			</div>
			<div class="opts" id="clusterOptions" hidden="true">
				<div style="text-align: right; background-color: #acc">
						<i class="material-icons" onclick="toggleClusterOptions()">close</i>
				</div>
				<fieldset>
					<legend>Automatic</legend>
					<label for="minPts">Min points: </label>
					<input type="number" value="6" id="minPts" title="Minimum number of nucleotides in a cluster" min=1><br>
					<label for="epsilon">Max dist (ε): </label>
					<input type="number" value="1.5" id="epsilon" title="Max distance between cluster neigbours" min=0>
					<button onclick="calculateClusters()">Start clustering</button>
				</fieldset>
				<fieldset>
					<legend>Manual</legend>
					<button onclick="selectionToCluster()" title="Add all selected elements to a new cluster">Selection to cluster</button>
					<button onclick="clearClusters()" title="Remove all clusters">Clear clusters</button>
				</fieldset>
			</div>
			<div class="opts" id="fogOptions" hidden="true">
				<div style="text-align: right; background-color: #acc">
						<i class="material-icons" onclick="toggleFogOptions()">close</i>
				</div>
				<label for="fogNear">Near: </label>
				<input type="number" value="1" id="fogNear" title="Minimum distance to apply fog" min=0 onchange="if(scene.fog!=null){setFog();}"><br>
				<label for="fogNear">Far: </label>
				<input type="number" value="200" id="fogFar" title="Maximum distance to apply fog" min=0 onchange="if(scene.fog!=null){setFog();}"><br>
				<button onclick="toggleFog()">Toggle fog</button>
			</div>
		</div>
		<canvas id="threeCanvas"></canvas>
		<div class="main"> <!--all files to be loaded onload of html file-->
			<script src="./ts/lib/CCapture.all.min.js"></script>
			<script src="./ts/lib/three.js"></script>
			<script src="./ts/lib/Lut.js"></script>
			<script src="./ts/controls/DragControls.js"></script>
			<script src="./ts/controls/TrackballControls.js"></script>
			<script src="./dist/scene_setup.js"></script>
			<script src="./dist/instancing.js"></script>
			<script src="./dist/mesh_setup.js"></script>
			<script src="./dist/io.js"></script>
			<script src="./dist/PBC_switchbox.js"></script>
			<script src="./dist/file_reading.js"></script>
			<script src="./dist/doUndo.js"></script>
			<script src="./dist/rigid-body_simulation.js"></script>
			<script src="./dist/main.js"></script>
			<script src="./dist/keybindings.js"></script>
			<script src="./dist/base_selector.js"></script>
			<script src="./dist/output_file.js"></script>
			<script src="./dist/translation.js"></script>
			<script src="./ts/controls/SceneUtils.js"></script>
			<script src="./dist/adhoc_api.js"></script>
		</div>

</body>

</html>
